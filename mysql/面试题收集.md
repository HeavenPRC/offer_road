#### 1.在mysql中N叉树的N值可以被调整么？

通过**InnoDB_page_size**修改页的大小渐间控制

在innodb到的引擎中，默认每个页的大小是16kb，由系统设定，与其他无关； b+tree的叶子节点存储的是行数据，其他节点存储的是主索引（针对primary key来说）；如果是非叶子节点；假设primary key 是int型，那么每个非叶子节点大小是4byte；一个页可以存储 16kb/4byte = 4k个索引（估算值，每个节点存在其他数据）。但是，如果是叶子节点，假设每行数据1kb（业内默认估算值），则每页只能存8条（16k/2/1kb）数据。

你说的那个point指针固定为6字节是从哪里看到的；我理解你的这个point指针是指primary key（简称 pk）；因为默认不指定pk的话，系统会自动生成一个6字节大小的pk；如果指定了pk的类型，那就是pk类型的长度了；

#### 2.如何避免长事务对业务的影响？

从应用开发端来看:

* 确认是否使用了 set autocommit=0。这个确认工作可以在测试环境中开展，把 MySQL 的 general_log 开起来，然后随便跑一个业务逻辑，通过 general_log 的日志来确认。一般框架如果会设置这个值，也就会提供参数来控制行为，你的目标就是把它改成 1。
* 确认是否有不必要的只读事务。有些框架会习惯不管什么语句先用 begin/commit 框起来。我见过有些是业务并没有这个需要，但是也把好几个 select 语句放到了事务中。这种只读事务可以去掉。
* 业务连接数据库的时候，根据业务本身的预估，通过 SET MAX_EXECUTION_TIME 命令，来控制每个语句执行的最长时间，避免单个语句意外执行太长时间。（为什么会意外？在后续的文章中会提到这类案例）

其次，从数据库端来看：

* 监控 information_schema.Innodb_trx 表，设置长事务阈值，超过就报警 / 或者 kill；
  Percona 的 pt-kill 这个工具不错，推荐使用；
* 在业务功能测试阶段要求输出所有的 general_log（会记录所有的sql操作），分析日志行为提前发现问题；
* 如果使用的是 MySQL  5.6 或者更新版本，把 innodb_undo_tablespaces 设置成 2（或更大的值）。如果真的出现大事务导致回滚段过大，这样设置后清理起来更方便。

#### 3.描述下MVCC

